<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.gdou.system.mapper.SysRoleMapper">

    <sql id="selectRoleVo">
        select distinct r.role_id,
                        r.role_name,
                        r.role_key,
                        r.role_sort,
                        r.status,
                        r.del_flag,
                        r.create_time
        from sys_role r
                 left join sys_user_role ur on ur.role_id = r.role_id
                 left join sys_user u on u.user_id = ur.user_id
    </sql>

    <select id="selectRolePermissionByUserId" resultType="com.gdou.common.domain.entity.SysRole" parameterType="Long">
            select  r.role_id,role_key from sys_role r,sys_user u,sys_user_role ur
            where   u.user_id = #{userId} and
                    r.role_id = ur.role_id and
                    u.user_id = ur.user_id and
                    r.del_flag = '0'
    </select>

    <select id="selectRolesByUsername" resultType="com.gdou.common.domain.entity.SysRole" parameterType="String">
        <include refid="selectRoleVo"></include>
        where u.user_name = #{username} and r.del_flag = '0'
    </select>
</mapper>